<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>Incident Response 101: Preserving Information – popped.io</title> <meta name="description" content="A collection of my security research, random projects and attempts to amuse."> <meta name="keywords" content="Incident Response, Preserving Information"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/me.png"> <meta name="twitter:title" content="Incident Response 101: Preserving Information"> <meta name="twitter:description" content="Often most people’s immediate response to a malware infection is to disconnect a host from the network. While this is a great precautionary action to prevent malware propagation, it destroys some valuable data that can be used for further investigations. This includes:"> <meta name="twitter:site" content="@hackerjiv"> <meta name="twitter:creator" content="@hackerjiv"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Incident Response 101: Preserving Information"> <meta property="og:description" content="Often most people’s immediate response to a malware infection is to disconnect a host from the network. While this is a great precautionary action to prevent malware propagation, it destroys some valuable data that can be used for further investigations. This includes:"> <meta property="og:url" content="http://localhost:4000/incident-response-101-preserving/"> <meta property="og:site_name" content="popped.io"> <meta property="og:image" content="http://localhost:4000/assets/img/me.png"> <link rel="canonical" href="http://localhost:4000/incident-response-101-preserving/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="popped.io Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png"> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <!-- Begin Jekyll SEO tag v2.2.3 --> <title>Incident Response 101: Preserving Information | popped.io</title> <meta property="og:title" content="Incident Response 101: Preserving Information"> <meta name="author" content="Sanjiv Kawa"> <meta property="og:locale" content="en_US"> <meta name="description" content="Often most people’s immediate response to a malware infection is to disconnect a host from the network. While this is a great precautionary action to prevent malware propagation, it destroys some valuable data that can be used for further investigations. This includes:"> <meta property="og:description" content="Often most people’s immediate response to a malware infection is to disconnect a host from the network. While this is a great precautionary action to prevent malware propagation, it destroys some valuable data that can be used for further investigations. This includes:"> <link rel="canonical" href="http://localhost:4000/incident-response-101-preserving/"> <meta property="og:url" content="http://localhost:4000/incident-response-101-preserving/"> <meta property="og:site_name" content="popped.io"> <meta property="og:type" content="article"> <meta property="article:published_time" content="2014-10-31T12:28:00-04:00"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@"> <meta name="twitter:creator" content="@Sanjiv Kawa"> <script type="application/ld+json"> {"@context":"http://schema.org","@type":"BlogPosting","headline":"Incident Response 101: Preserving Information","author":{"@type":"Person","name":"Sanjiv Kawa"},"datePublished":"2014-10-31T12:28:00-04:00","dateModified":"2014-10-31T12:28:00-04:00","description":"Often most people’s immediate response to a malware infection is to disconnect a host from the network. While this is a great precautionary action to prevent malware propagation, it destroys some valuable data that can be used for further investigations. This includes:","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/me.png"},"name":"Sanjiv Kawa"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/incident-response-101-preserving/"},"url":"http://localhost:4000/incident-response-101-preserving/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/me.png" alt="popped.io photo" class="author-photo"> <h4>popped.io</h4> <p>A collection of my security research, random projects and attempts to amuse.</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:sanjiv@popped.io" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://twitter.com/hackerjiv" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://linkedin.com/in/sanjivkawa" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://github.com/skahwah" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://localhost:4000/posts/">All Posts</a></li> <li><a href="http://localhost:4000/tags/">All Tags</a></li> </ul> </li> <li><a href="http://localhost:4000/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Incident Response 101: Preserving Information</h1> <h4>31 Oct 2014</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~2 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://localhost:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <p>Often most people’s immediate response to a malware infection is to disconnect a host from the network. While this is a great precautionary action to prevent malware propagation, it destroys some valuable data that can be used for further investigations. This includes:</p> <ul> <li>Active network connections</li> <li>Active processes which rely on active network connections</li> </ul> <p>Scenario: Lets assume, that an attacker has a reverse shell on a host in your environment. If we disconnect the host from the network, that established network connection dies. Therefore, you have no way of identifying who the attacker is, what their IP address is, and you have no way to prevent further communications by means of blocking the attackers IP address at the firewall level.</p> <p>As a result, disconnecting an infected host is not the first thing that should be done when responding to an incident. Information gathering and the preservation of that information is.</p> <p>The information that should be gathered consists of time stamps, network connections which are listening and/or established, system information, current running processes and users in the administrators group.</p> <p>I’ve created a pretty speedy script (&lt;5 seconds run time) which gathers all of this information in a text file named $hostname.txt on the Desktop of the current user. The script can be found <a href="https://drive.google.com/file/d/0B9YAGU9c9zmKOWQ2T2YzSXY5TFE/view?usp=sharing">here</a>.</p> <p>After this information is gathered, the next steps in the incident response procedure can be taken. This is where you can determine whether network isolation is necessary or not.</p> <p>Here is a sample of the output generated for my script:</p> <figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="o">[*]</span> <span class="nt">IR</span> <span class="nt">DUMP</span>  
 <span class="o">[*]</span> <span class="nt">Created</span> <span class="nt">by</span><span class="o">:</span> <span class="nt">Sanjiv</span> <span class="nt">Kawa</span>  
 <span class="o">[*]</span> <span class="nt">Starting</span> <span class="nt">IR</span> <span class="nt">DUMP</span>  
 <span class="o">[*]</span> <span class="nt">Captured</span> <span class="nt">on</span> <span class="nt">Fri</span> <span class="nt">10</span><span class="o">/</span><span class="nt">31</span><span class="o">/</span><span class="nt">2014</span> <span class="nt">10</span><span class="nd">:15:10</span><span class="nc">.06</span>  
 <span class="o">[*]</span> <span class="nt">Finding</span> <span class="nt">ESTABLISHED</span> <span class="nt">TCP</span> <span class="nt">Connections</span>  
  <span class="nt">TCP</span>  <span class="nt">192</span><span class="nc">.168.1.2</span><span class="nd">:64817</span>  <span class="nt">132</span><span class="nc">.245.81.130</span><span class="nd">:443</span>   <span class="nt">ESTABLISHED</span>   <span class="nt">2600</span>  
 <span class="o">[*]</span> <span class="nt">Finding</span> <span class="nt">TCP</span> <span class="nt">Services</span> <span class="nt">LISTENING</span> <span class="nt">for</span> <span class="nt">Connection</span>  
  <span class="nt">TCP</span>  <span class="nt">0</span><span class="nc">.0.0.0</span><span class="nd">:80</span>       <span class="nt">0</span><span class="nc">.0.0.0</span><span class="nd">:0</span>       <span class="nt">LISTENING</span>    <span class="nt">5824</span>  
  <span class="nt">TCP</span>  <span class="nt">0</span><span class="nc">.0.0.0</span><span class="nd">:135</span>      <span class="nt">0</span><span class="nc">.0.0.0</span><span class="nd">:0</span>       <span class="nt">LISTENING</span>    <span class="nt">344</span>  
  <span class="nt">TCP</span>  <span class="nt">0</span><span class="nc">.0.0.0</span><span class="nd">:443</span>      <span class="nt">0</span><span class="nc">.0.0.0</span><span class="nd">:0</span>       <span class="nt">LISTENING</span>    <span class="nt">2584</span>  
  <span class="nt">TCP</span>  <span class="nt">0</span><span class="nc">.0.0.0</span><span class="nd">:445</span>      <span class="nt">0</span><span class="nc">.0.0.0</span><span class="nd">:0</span>       <span class="nt">LISTENING</span>    <span class="nt">4</span>  
 <span class="o">[*]</span> <span class="nt">Finding</span> <span class="nt">ESTABLISHED</span> <span class="nt">UDP</span> <span class="nt">Connections</span>  
 <span class="o">[*]</span> <span class="nt">Finding</span> <span class="nt">UDP</span> <span class="nt">Services</span> <span class="nt">LISTENING</span> <span class="nt">for</span> <span class="nt">Connection</span>  
 <span class="o">[*]</span> <span class="nt">Getting</span> <span class="nt">Running</span> <span class="nt">Processes</span>  
 <span class="nt">avp</span><span class="nc">.exe</span>            <span class="nt">2600</span> <span class="nt">Services</span>          <span class="nt">0</span>   <span class="nt">66</span><span class="o">,</span><span class="nt">640</span> <span class="nt">K</span>  
 <span class="nt">Skype</span><span class="nc">.exe</span>           <span class="nt">5824</span> <span class="nt">Console</span>          <span class="nt">1</span>  <span class="nt">165</span><span class="o">,</span><span class="nt">424</span> <span class="nt">K</span>  
 <span class="o">[*]</span> <span class="nt">Getting</span> <span class="nt">System</span> <span class="nt">Information</span>  
 <span class="nt">OS</span> <span class="nt">Manufacturer</span><span class="o">:</span>      <span class="nt">Microsoft</span> <span class="nt">Corporation</span>  
 <span class="nt">System</span> <span class="nt">Type</span><span class="o">:</span>        <span class="nt">x64-based</span> <span class="nt">PC</span>  
 <span class="nt">Windows</span> <span class="nt">Directory</span><span class="o">:</span>     <span class="nt">C</span><span class="o">:</span><span class="err">\</span><span class="nt">windows</span>  
 <span class="nt">System</span> <span class="nt">Directory</span><span class="o">:</span>     <span class="nt">C</span><span class="o">:</span><span class="err">\</span><span class="nt">windows</span><span class="err">\</span><span class="nt">system32</span>  
 <span class="nt">Hotfix</span><span class="o">(</span><span class="nt">s</span><span class="o">):</span>         <span class="nt">92</span> <span class="nt">Hotfix</span><span class="o">(</span><span class="nt">s</span><span class="o">)</span> <span class="nt">Installed</span><span class="o">.</span>  
               <span class="o">[</span><span class="nt">01</span><span class="o">]:</span> <span class="nt">KB2899189_Microsoft-Windows-CameraCodec-Package</span>  
 <span class="o">[*]</span> <span class="nt">Getting</span> <span class="nt">Local</span> <span class="nt">Administrator</span> <span class="nt">Accounts</span>  
 <span class="nt">Alias</span> <span class="nt">name</span>   <span class="nt">administrators</span>  
 <span class="nt">Comment</span>    <span class="nt">Administrators</span> <span class="nt">have</span> <span class="nt">complete</span> <span class="nt">and</span> <span class="nt">unrestricted</span> <span class="nt">access</span> <span class="nt">to</span> <span class="nt">the</span> <span class="nt">computer</span><span class="o">/</span><span class="nt">domain</span>  
 <span class="nt">Members</span>  
 <span class="nt">-------------------------------------------------------------------------------</span>  
 <span class="nt">Administrator</span>  
 <span class="nt">sanjiv</span>  
 <span class="nt">The</span> <span class="nt">command</span> <span class="nt">completed</span> <span class="nt">successfully</span><span class="o">.</span></code></pre></figure> <div class="entry-meta">  <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#Incident%20Response" title="Pages tagged Incident Response" class="tag"><span class="term">Incident Response</span></a><a href="http://localhost:4000/tags/#Preserving%20Information" title="Pages tagged Preserving Information" class="tag"><span class="term">Preserving Information</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/incident-response-101-preserving/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Like</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/incident-response-101-preserving/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/incident-response-101-preserving/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <!-- Asynchronous Google Analytics snippet --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-85516324-1', 'auto'); ga('require', 'linkid', 'linkid.js'); ga('send', 'pageview'); </script> <script type="text/javascript"> var disqus_shortname = 'sanjivkawa'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>  </body>
</html>
